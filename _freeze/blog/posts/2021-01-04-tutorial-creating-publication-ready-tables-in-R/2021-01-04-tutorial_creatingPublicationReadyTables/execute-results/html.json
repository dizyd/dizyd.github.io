{
  "hash": "703aaf758a9817bc5846ed5590318077",
  "result": {
    "markdown": "---\nlayout: single\ntitle: \"Short Tutorial: Creating Publication Ready Tables With `papaja` and `kable()`\"\nexcerpt: In this short tutorial, I want to demonstrate how to build publication ready `LaTeX` tables in R with the [`papaja`](https://github.com/crsh/papaja) package and the `kable()` function.\n\ndate: 2021-01-04\ntags:\n  - APA conform tables\n  - R\n# status: publish\n# published: true\npermalink: /posts/2021/01/creatingtables/\n---\n\n\n\n\nIn this short tutorial, I want to demonstrate how to build publication ready `LaTeX` tables in R with the [`papaja`](https://github.com/crsh/papaja) package and the `kable()` function.\n\n\n## Getting started\n\nBefore we can start, we need to install and load the packages we need for this tutorial. The `papaja` package can be installed directly from github, see the [manual](https://crsh.github.io/papaja_man/introduction.html#getting-started) for more information. \n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(papaja)\nlibrary(knitr)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Paket 'knitr' wurde unter R Version 4.1.3 erstellt\n```\n:::\n\n```{.r .cell-code}\nlibrary(kableExtra)\nlibrary(tidyverse)\n```\n:::\n\nLets also create an example results data.frame based on the `mtcars` data set, which we would like to convert to a nice table ready for publication. \n\n::: {.cell}\n\n```{.r .cell-code}\n(temp0 <- mtcars %>% \n            group_by(gear) %>% \n            summarize(mean = mean(mpg),\n                      sd   = sd(mpg),\n                      corr = cor.test(mpg,hp)$estimate,\n                      p    = cor.test(mpg,hp)$p.value,\n                      .groups=\"keep\") %>%\n            as.data.frame()) #for nicer printing\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  gear     mean       sd       corr            p\n1    3 16.10667 3.371618 -0.7389022 0.0016495333\n2    4 24.53333 5.276764 -0.8792697 0.0001643918\n3    5 21.38000 6.658979 -0.8998444 0.0374724809\n```\n:::\n:::\n\nThis data.frame `temp0` now contains the mean and standard deviation of miles per gallon, the correlation of miles per gallon and horsepower, as well as the corresponding *p*-value, for each factor level of number of gears. \n\n## Generate LaTeX-Table\n\nTo generate the LaTeX-Code for this data.frame, we can use the `kable()` function:\n\n::: {.cell}\n\n```{.r .cell-code}\nkable(temp0,format = \"latex\",booktabs=TRUE)\n```\n:::\n\nRunning this line of code in R gives us the following LaTeX-Code as output,\n\n::: {.cell}\n\n```{.r .cell-code}\n\\begin{tabular}{rrrrr}\n\\toprule\ngear & mean & sd & corr & p\\\\\n\\midrule\n3 & 16.10667 & 3.371618 & -0.7389022 & 0.0016495\\\\\n4 & 24.53333 & 5.276764 & -0.8792697 & 0.0001644\\\\\n5 & 21.38000 & 6.658979 & -0.8998444 & 0.0374725\\\\\n\\bottomrule\n\\end{tabular}\n```\n:::\n\nwhich leads to this table:\n\n{% include figure image_path=\"assets/img/images_tables/table1.PNG\" %}{: .full}\n\n\n## Formatting the values inside the table\n\nAs a first step to improve this table, we can format the output of the values inside the table. For this we can use the functions `printnum()` and `printp()` from the `papaja` package. These functions format numerical values according to APA-Style. We can just wrap these functions around our variables and define specific properties of the variables. For instance with `gt1=FALSE`, we can indicate that the correlation variable can not have values greater than 1.\n\n::: {.cell}\n\n```{.r .cell-code}\n(temp1 <-  temp0 %>% \n              mutate(mean = printnum(mean),\n                     sd   = printnum(sd), \n                     corr = printnum(corr,gt1=FALSE),\n                     p    = printp(p))  %>%\n              as.data.frame())\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  gear  mean   sd corr      p\n1    3 16.11 3.37 -.74   .002\n2    4 24.53 5.28 -.88 < .001\n3    5 21.38 6.66 -.90   .037\n```\n:::\n:::\n\nWhen we now use this new data.frame in kable, we get the following table [I will omit the underlying LaTeX-Code from now on, but running the code in RStudio or the Console will still print the code]: \n\n::: {.cell}\n\n```{.r .cell-code}\nkable(temp1 ,format = \"latex\",booktabs=TRUE)\n```\n:::\n\n{% include figure image_path=\"assets/img/images_tables/table2.PNG\" %}{: style=\"max-width: 80%; display: block; margin: 2em auto;\"}\n\n\nThis table looks already a little bit nicer than the previous one. Often we report composites of multiple descriptive statistics in one column, for instance the mean and then the standard deviation in parenthesis. We can easily implement this in R by using the `paste0()` \n\n::: {.cell}\n\n```{.r .cell-code}\n(temp2 <-  temp1 %>% \n              mutate(mean_sd = paste0(mean,\" (\",sd,\")\"))  %>%\n              select(gear,mean_sd,corr,p) )\n\nkable(temp2 ,format = \"latex\",booktabs=TRUE)\n```\n:::\n\n{% include figure image_path=\"assets/img/images_tables/table3.PNG\" %}{: style=\"max-width: 80%; display: block; margin: 2em auto;\"}\n\n## Changing the variable namens in the table\n\nAs a next step, we could change the variable names displayed in the table and also change the alignment of the columns. While you could just change the variable names of the data.frame in R, a better solution would be to use the `kable()` function directly. With the argument `align=\"c\"` I defined that now every column is center aligned. You can also specify a different alignment for each column by supplying a vector to `align=`. For instance `align=c(\"l\",\"l\",\"r\",\"r\",\"c\")` would make the first two columns be left aligned, the next two columns right aligned, and the last column center aligned. In addition, I changed the column names with the `col.names` argument. Wrapping variable names between \"\\$\\$\" together with `escape    = FALSE` toggles the math-mode of LaTeX and thus makes them italic. \n\n::: {.cell}\n\n```{.r .cell-code}\ntemp2 %>%\n  kable(.,format    = \"latex\",booktabs=TRUE,\n          align     = \"c\",\n          col.names = c(\"Gears\",\"Miles per Gallon\",\"$r$\",\"$p$\"),\n          escape    = FALSE)\n```\n:::\n\n{% include figure image_path=\"assets/img/images_tables/table4.PNG\" %}{: style=\"max-width: 80%; display: block; margin: 2em auto;\"}\n\n## Adding table notes and captions\n\nIt is also straightforward to add captions and notes to a table, by again using the arguments of the `kable()`function or the `footnote()`function from the `kableExtra` package.\n\n::: {.cell}\n\n```{.r .cell-code}\ntemp2 %>%\n  kable(.,format    = \"latex\",booktabs=TRUE,\n          align     = \"c\",\n          col.names = c(\"Gears\",\"Miles per Gallon\",\"$r$\",\"$p$\"),\n          escape    = FALSE,\n          caption   = \"This is caption\")  %>%\n  footnote(general  = \"This is a note\",\n           footnote_as_chunk = TRUE,\n           threeparttable    = T,\n           escape            = F,\n           general_title     = \"Note.\",\n           title_format      = c(\"italic\"))\n```\n:::\n\n{% include figure image_path=\"assets/img/images_tables/table5.PNG\" %}{: style=\"max-width: 80%; display: block; margin: 2em auto;\"}\n\n## Adding interim-headers\n\nTo add more structure and details to your table, you can also use the `add_header_above()`function to add some interim-headers inside your table. For instance adding `add_header_above(c(\" \" = 1, \"Estimates\" = 2))`  creates an additional header over  the second and third variable (i.e. the two columns after the first).\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntemp2 %>%\n  kable(.,format    = \"latex\",booktabs=TRUE,\n          align     = \"c\",\n          col.names = c(\"Gears\",\"Miles per Gallon\",\"$r$\",\"$p$\"),\n          escape    = FALSE,\n          caption   = \"This is caption\")  %>%\n  footnote(general  = \"This is a note\",\n           footnote_as_chunk = TRUE,\n           threeparttable    = T,\n           escape            = F,\n           general_title     = \"Note.\",\n           title_format      = c(\"italic\")) %>%\n  add_header_above(c(\"Estimates\" = 2))\n```\n:::\n\n{% include figure image_path=\"assets/img/images_tables/table6.PNG\" %}{: style=\"max-width: 80%; display: block; margin: 2em auto;\"}\n\n## Using additional LaTeX\n\nIt is also possible to use additional LaTeX packages and LaTeX-code in your table. For instance you can add equations and other math-options like indices. For instance, here I added an equation and some variable indexing in the note and the variable names.\n\n::: {.cell}\n\n```{.r .cell-code}\ntemp2 %>%\n  kable(.,format    = \"latex\",booktabs=TRUE,\n          align     = \"c\",\n          col.names = c(\"Gears\",\"Miles per Gallon\",\"$r_{hp \\\\times mpg}$\",\"$p$\"),\n          escape    = FALSE,\n          caption   = \"This is caption\")  %>%\n  footnote(general  = \"$E = m \\\\\\\\times c^{2}$. $x_1$ and $x_2$\",\n           footnote_as_chunk = TRUE,\n           threeparttable    = T,\n           escape            = F,\n           general_title     = \"Note.\",\n           title_format      = c(\"italic\")) %>%\n  add_header_above(c(\"Estimates\" = 2))\n```\n:::\n\n{% include figure image_path=\"assets/img/images_tables/table7.PNG\" %}{: style=\"max-width: 80%; display: block; margin: 2em auto;\"}\n\n\nIn addition, by adding the following line in the YAML-header of your papaja-document, you can use the more advanced column formatting options of the `siunitx` LaTeX-package. \n\n::: {.cell}\n\n```{.r .cell-code}\nheader-includes   :\n   - \\usepackage{siunitx}\n   - \\sisetup{add-integer-zero=false}\n```\n:::\n\nChanging the `align = \"c\"` argument to `align     = \"ccccS[table-format=< .3]\"` ensures right alignemt of the *p*-value column which can include a special character (i.e., <) in some cases.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntemp2 %>%\n  kable(.,format    = \"latex\",booktabs=TRUE,\n          align     = \"cccS[table-format=< .3]\",\n          col.names = c(\"Gears\",\"Miles per Gallon\",\"$r_{hp \\\\times mpg}$\",\"$p$\"),\n          escape    = FALSE,\n          caption   = \"This is caption\")  %>%\n  footnote(general  = \"$E = m \\\\\\\\times c^{2}$. $x_1$ and $x_2$\",\n           footnote_as_chunk = TRUE,\n           threeparttable    = T,\n           escape            = F,\n           general_title     = \"Note.\",\n           title_format      = c(\"italic\")) %>%\n  add_header_above(c(\"Estimates\" = 2))\n```\n:::\n\n\n{% include figure image_path=\"assets/img/images_tables/table8.PNG\" %}{: style=\"max-width: 80%; display: block; margin: 2em auto;\"}",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": null
  }
}